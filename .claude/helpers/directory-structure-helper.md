# ディレクトリ構成決定ヘルパー

## 目的

プロジェクトに最適なディレクトリ構成を、**ユーザーと相談しながら**決定するためのヘルパーです。

**基本方針:**
- 画一的な構成を押し付けない
- プロジェクト規模・ユーザーの要望に応じて柔軟に対応
- 最新のベストプラクティスを調査して提案
- 受託開発レベルの詳細度を基準に、ユーザーと相談して削る

---

## 1. 調査・決定フロー

### ステップ1: プロジェクト情報の収集

以下の情報を要件定義書・設計書から抽出:

- **プロジェクト規模**:
  - 小規模（1-2人、1-3ヶ月）
  - 中規模（3-5人、3-6ヶ月）
  - 大規模（6人以上、6ヶ月以上）

- **技術スタック**:
  - フロントエンド: {React/Vue/Next.js/etc}
  - バックエンド: {Node.js/Python/Go/etc}
  - インフラ: {Terraform/CloudFormation/CDK/etc}

- **アーキテクチャ**:
  - モノリシック / マイクロサービス / マイクロフロントエンド
  - モノレポ / マルチレポ

- **チーム構成**:
  - フルスタック / フロント・バック分離
  - 経験レベル（ジュニア多め / シニア多め）

### ステップ2: ベストプラクティス調査

**WebSearch または WebFetch で調査:**

#### アプリケーションの場合

```
調査キーワード例:
- "{技術名} directory structure best practices 2025"
- "{技術名} project structure {規模} scale"
- "{技術名} folder organization enterprise"
```

**調査すべき情報源:**
1. 公式ドキュメント（最優先）
2. 著名な OSS プロジェクト
3. 技術ブログ・記事（Vercel、Netlify等）
4. コミュニティ推奨パターン

**確認ポイント:**
- [ ] 公式推奨構成はあるか？
- [ ] プロジェクト規模別の推奨は？
- [ ] 機能別 vs レイヤー別、どちらが適切か？
- [ ] モノレポツール（Turborepo、Nx等）の採用余地は？

#### インフラの場合

```
調査キーワード例:
- "{IaCツール} project structure best practices 2025"
- "{IaCツール} module organization"
- "terraform directory structure {規模} environments"
```

**確認ポイント:**
- [ ] 環境分離の方法（Workspace / ディレクトリ分離 / etc）
- [ ] モジュール化の粒度
- [ ] 状態管理（Backend）の方針
- [ ] シークレット管理の配置

### ステップ3: プロジェクト固有要件の考慮

**追加検討事項:**

- **保守性**:
  - 新メンバーが理解しやすいか？
  - ファイル数が多すぎないか？

- **スケーラビリティ**:
  - 機能追加時に破綻しないか？
  - チーム拡大に対応できるか？

- **ビルド・デプロイ**:
  - CI/CDとの相性は？
  - モノレポ時のビルド最適化は？

### ステップ4: 構成の決定と文書化

**決定事項を設計書に記載:**

```markdown
## ディレクトリ構成

### 採用構成
{実際の構成を記載}

### 選定理由
- **規模**: {小規模なので、シンプルな構成を採用}
- **技術**: {Next.js App Router の公式推奨構成に準拠}
- **チーム**: {フルスタック開発なので機能別に分割}

### 調査結果
- 参考: [Next.js Project Structure - Official Docs](https://nextjs.org/docs/...)
- 参考: [Bulletproof React](https://github.com/...)
- 検討した代替案: {レイヤー別構成も検討したが、機能追加の局所性を優先}
```

---

## 2. 規模別の一般的な傾向（参考）

### 小規模プロジェクト
- **シンプルな構成**を優先
- フラットなディレクトリ（ネスト浅め）
- 公式推奨構成をそのまま採用

### 中規模プロジェクト
- **機能別分割**が一般的
- 共通コンポーネントの分離
- 適度なモジュール化

### 大規模プロジェクト
- **モノレポ**検討
- **ドメイン駆動設計**の境界に沿った分割
- 厳密なレイヤー分離

---

## 3. Claude の動作

### いつこのヘルパーを使うか

- **設計フェーズ**でディレクトリ構成を決定する時
- 設計書テンプレートの「ディレクトリ構成」セクションを埋める前

### 具体的な手順

1. **プロジェクト情報を抽出**（要件定義書から）

2. **WebSearch で調査**:
   ```
   例: WebSearch "Next.js 14 directory structure best practices 2025"
   ```

3. **調査結果を分析**:
   - 公式推奨を確認
   - 複数の情報源を比較
   - プロジェクト要件とのマッチング

4. **構成を決定**:
   - 選定理由を明記
   - 代替案も記録

5. **設計書に記載**:
   - 構成図
   - 選定理由
   - 参考資料リンク

---

## 4. 注意事項

### ❌ やってはいけないこと
- 調査せずに固定的な構成を押し付ける
- 古い情報（2年以上前）を鵜呑みにする
- プロジェクト規模を無視した複雑な構成

### ✅ 推奨すること
- 必ず最新情報を調査（2024-2025年）
- 公式ドキュメントを最優先
- プロジェクト規模に応じたシンプルさを保つ
- 選定理由を明確に文書化

---

## 5. 関連ドキュメント

- [18_best-practice-research-flow.md](../.claude/docs/10_facilitation/18_best-practice-research-flow.md) - ベストプラクティス調査フロー
- [2.3.6_製造物_詳細設計書構成.md](../.claude/docs/10_facilitation/2.3_設計フェーズ/2.3.6_製造物_詳細設計書構成.md) - 詳細設計書構成
