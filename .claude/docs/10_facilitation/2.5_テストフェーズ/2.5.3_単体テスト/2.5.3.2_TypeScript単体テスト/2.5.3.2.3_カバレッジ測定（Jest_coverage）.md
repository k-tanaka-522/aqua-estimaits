# 2.5.3.2.3 カバレッジ測定（Jest coverage）

## 目的

テストカバレッジを測定し、80%以上を達成します。

---

## 📊 カバレッジ測定

### jest.config.js 設定

```javascript
module.exports = {
  preset: 'ts-jest',
  testEnvironment: 'node',
  collectCoverage: true,
  coverageDirectory: 'coverage',
  collectCoverageFrom: [
    'src/**/*.{ts,tsx}',
    '!src/**/*.d.ts',
    '!src/**/*.test.ts',
    '!src/index.ts',
  ],
  coverageThresholds: {
    global: {
      branches: 80,
      functions: 80,
      lines: 80,
      statements: 80,
    },
  },
};
```

### 実行

```bash
# カバレッジ付きでテスト実行
npm test -- --coverage

# カバレッジレポート生成（HTML）
npm test -- --coverage --coverageReporters=html

# カバレッジレポート確認
open coverage/index.html
```

### package.json スクリプト

```json
{
  "scripts": {
    "test": "jest",
    "test:coverage": "jest --coverage",
    "test:watch": "jest --watch",
    "test:ci": "jest --coverage --ci --maxWorkers=2"
  }
}
```

### 目標

- ✅ **カバレッジ80%以上**
- ✅ 重要な業務ロジック: 90%以上
- ✅ エラーハンドリング分岐も網羅

### カバレッジレポートの見方

```
-------------------|---------|----------|---------|---------|-------------------
File               | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s
-------------------|---------|----------|---------|---------|-------------------
All files          |   85.7  |   80.0   |   90.0  |   85.7  |
 userService.ts    |   90.0  |   85.0   |  100.0  |   90.0  | 42-45
 productService.ts |   80.0  |   75.0   |   80.0  |   80.0  | 18,27-30
-------------------|---------|----------|---------|---------|-------------------
```

- **Stmts**: 文カバレッジ
- **Branch**: 分岐カバレッジ
- **Funcs**: 関数カバレッジ
- **Lines**: 行カバレッジ

---

**作成日**: 2025-10-19
**重要度**: ⭐⭐⭐
