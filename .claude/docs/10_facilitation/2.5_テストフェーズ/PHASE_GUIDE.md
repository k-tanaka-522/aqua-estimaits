# テストフェーズ実行ガイド（PHASE_GUIDE）

## このドキュメントの目的

**Claude（あなた）がテストフェーズを実行するための唯一のエントリーポイント**

- ユーザーとの一問一答でテストフェーズを進める
- PDCA 2周でテスト実施・不具合修正・品質保証
- テスト完了して次フェーズへ遷移

**重要**: このファイルを読めば、テストフェーズで何をすべきか全てわかります。他のファイルは参照用です。

**注意**: **実装フェーズで単体テストは実施済み**。このフェーズでは統合テスト以降を実施します。

---

## §1 このフェーズでやること（What）

### 1.1 テストフェーズの目的

**実装されたシステムをテストし、本番デプロイ可能な品質を保証する**

- **Input**: 実装コード（`src/`、`tests/`、`infra/` 等）、基本設計書
- **Output**: テスト計画書、テスト結果報告書、カバレッジレポート
- **成果物の品質**: 受託開発納品レベル（本番デプロイ可能、品質保証済み）

### 1.2 テストフェーズで実施すること

以下のテストを**すべて**実施します（省略禁止）:

#### A. 統合テスト（Integration Test） ⭐⭐⭐
- [ ] API結合テスト（エンドポイント間の連携）
- [ ] DB結合テスト（トランザクション処理、データ整合性）
- [ ] 外部システム結合テスト（外部API連携、タイムアウト処理）

#### B. E2Eテスト（End-to-End Test） ⭐⭐⭐
- [ ] ユーザーシナリオテスト（主要フローの動作確認）
- [ ] クロスブラウザテスト（Chrome、Firefox、Safari等）
- [ ] レスポンシブテスト（PC、タブレット、スマホ）

#### C. 性能テスト（Performance Test） ⭐⭐
- [ ] 負荷テスト（通常負荷での性能確認）
- [ ] ストレステスト（限界負荷での動作確認）
- [ ] スパイクテスト（急激な負荷増加への対応）
- [ ] 耐久テスト（長時間運用での安定性確認）

#### D. セキュリティテスト（Security Test） ⭐⭐⭐
- [ ] 脆弱性スキャン（OWASP Top 10）
- [ ] 依存関係スキャン（脆弱なライブラリの検出）
- [ ] 認証・認可テスト（未認証アクセス拒否、権限外操作拒否）
- [ ] 入力バリデーションテスト（SQLインジェクション、XSS対策）

#### E. 障害テスト（Failure Test） ⭐⭐
- [ ] 障害復旧テスト（バックアップ・リストア手順）
- [ ] フェイルオーバーテスト（冗長化構成の自動切り替え）
- [ ] カオスエンジニアリング（ランダムな障害注入）

#### F. ユーザー受入テスト（UAT: User Acceptance Test） ⭐⭐⭐
- [ ] UAT計画策定（ユーザーシナリオ、テスト環境）
- [ ] UAT実施（ユーザー参加、実業務に基づくテスト）
- [ ] UAT結果評価（合格基準判定、ユーザー承認取得）

### 1.3 テストフェーズの制約

- **実装コードとの整合性**: すべてのテストは実装コードに基づく
- **技術標準の遵守**: `.claude/docs/40_standards/` の技術標準を必ず参照
- **テストカバレッジ**: 単体テスト80%以上（実装フェーズで達成済み）
- **不具合ゼロ**: Critical/Highの不具合はゼロ、Mediumは2件以下

### 1.4 テストピラミッド

```
      /\
     /E2E\         少ない（重要シナリオのみ）
    /------\
   /統合テスト\      中程度（主要フローをカバー）
  /----------\
 /単体テスト   \    多い（カバレッジ80%以上）← 実装フェーズで完了
/==============\
```

**原則**:
- ✅ 単体テストは実装フェーズで完了済み
- ✅ 統合テストで主要フローをカバー
- ✅ E2Eテストは重要シナリオのみ
- ✅ 非機能要件の検証も必須（性能、セキュリティ、障害）

---

## §2 技術標準参照

### 2.1 参照すべき技術標準

テスト設計時には、以下の技術標準を**必ず参照**してください:

| 技術標準ファイル | 参照タイミング | 必須度 |
|----------------|--------------|--------|
| `.claude/docs/40_standards/49_security.md` | セキュリティテスト設計時 | ⭐⭐⭐ 必須 |
| `.claude/docs/40_standards/41_python.md` | Python単体テスト確認時 | ⭐⭐⭐ 必須 |
| `.claude/docs/40_standards/42_typescript.md` | TypeScript単体テスト確認時 | ⭐⭐⭐ 必須 |
| `.claude/docs/40_standards/43_csharp.md` | C#単体テスト確認時 | ⭐⭐⭐ 必須 |
| `.claude/docs/40_standards/44_go.md` | Go単体テスト確認時 | ⭐⭐⭐ 必須 |
| `.claude/docs/40_standards/45_cloudformation.md` | CloudFormationテスト時 | ⭐⭐ 推奨 |
| `.claude/docs/40_standards/46_terraform.md` | Terraformテスト時 | ⭐⭐ 推奨 |

### 2.2 技術標準の適用方針

**技術標準は厳守**（テストフェーズでは技術標準に従ってテストを設計・実施）

- ✅ テストカバレッジ基準を満たす（80%以上）
- ✅ セキュリティテスト項目を網羅（`.claude/docs/40_standards/49_security.md`）
- ✅ 技術標準のテストパターンに従う

---

## §3 PDCA 1周目（テスト実施）

### 3.1 Plan（計画）

**実装コードを確認して、テスト戦略を立てる**

#### ステップ1: 実装コードの確認

```bash
# 実装コードを確認
src/
tests/
infra/
```

**確認すべき項目:**
- [ ] アーキテクチャパターン（マイクロサービス、モノリス、サーバーレス等）
- [ ] 技術スタック（Python、TypeScript、C#、Go等）
- [ ] 単体テストの実施状況（カバレッジ80%以上か）
- [ ] インフラ構成（AWS、GCP、オンプレ等）

#### ステップ2: 技術標準の確認

**参照ドキュメント**: `2.5.0_事前調査.md`

**テスト設計前に必ず実施:**

1. **技術標準の精読**
   - 該当する技術標準ページを特定（例: Python → `41_python.md`）
   - テストカバレッジ基準を確認（80%以上）
   - テストパターン（Good/Bad Example）を確認

2. **セキュリティテスト項目の確認**
   - `49_security.md` を精読
   - OWASP Top 10 の確認
   - 認証・認可、入力バリデーション、データ保護の確認

3. **最新テストツール調査（WebSearch）**
   - テストツールの最新バージョン確認
   - 最新テスト手法の確認（テストピラミッド/トロフィー等）

#### ステップ3: テスト戦略の策定

**ユーザーへの質問例:**

> 「実装コードを確認しました。テストフェーズを開始します。
>
> **実装状況:**
> - アーキテクチャ: マイクロサービス（ECS Fargate）
> - 技術スタック: Python (FastAPI)
> - 単体テストカバレッジ: 87%（目標80%達成済み✅）
>
> **テスト戦略の提案:**
>
> 1. **統合テスト**（API結合、DB結合、外部システム結合）
>    - FastAPIのTestClientで全エンドポイントをテスト
>    - データベーストランザクション処理の検証
>    - 外部API連携（タイムアウト、リトライ）の検証
>
> 2. **E2Eテスト**（Playwright使用）
>    - 主要シナリオ: ユーザー登録→ログイン→データ作成→削除
>    - クロスブラウザテスト（Chrome、Firefox）
>
> 3. **性能テスト**（Locust使用）
>    - 負荷テスト: 同時接続100ユーザー、レスポンスタイム500ms以内
>    - ストレステスト: 限界負荷の特定
>
> 4. **セキュリティテスト**（OWASP ZAP使用）
>    - 脆弱性スキャン（OWASP Top 10）
>    - 認証・認可テスト
>    - SQLインジェクション・XSS対策テスト
>
> 5. **UAT**（ユーザー参加）
>    - 実業務シナリオに基づくテスト
>
> この戦略で進めて問題ないですか？または、優先順位を変更しますか？」

**重要**: 一度に複数の質問をしない。1つずつ確認する。

### 3.2 Do（実行）

**テスト戦略に基づいてテストを実施する**

#### テスト実施の原則

**事前説明 → 実施 → 結果報告**

1. **事前説明**: これから実施するテストの概要を説明
2. **実施**: テストを実施
3. **結果報告**: テスト結果を報告（成功/失敗、カバレッジ、不具合等）

**例: 統合テスト実施**

> 「**事前説明:**
> これから、統合テストを実施します。FastAPIのTestClientを使って、全APIエンドポイントの動作を確認します。
>
> **テスト対象:**
> - POST /api/users - ユーザー登録
> - GET /api/users/{id} - ユーザー取得
> - PUT /api/users/{id} - ユーザー更新
> - DELETE /api/users/{id} - ユーザー削除
>
> （テスト実施）
>
> **結果報告:**
> - テスト実施: 25件
> - 合格: 24件
> - 不合格: 1件（PUT /api/users/{id} でバリデーションエラー）
>
> **不具合詳細:**
> - BUG-001: ユーザー更新時、メールアドレスの重複チェックが機能していない
> - 優先度: High
> - 影響範囲: ユーザー更新API
> - 対応方針: 実装を修正して再テスト
>
> 不具合を修正してから次のテストに進みますか？」

#### テスト実施の流れ

**統合テスト → E2Eテスト → 性能テスト → セキュリティテスト → UAT**

**1. 統合テスト実施**

**参照ドキュメント**: `2.5.4_結合テスト/`

```python
# 統合テスト例（Python/FastAPI）

import pytest
from fastapi.testclient import TestClient
from src.main import app

client = TestClient(app)

class TestUserAPI:
    """ユーザーAPI統合テスト"""

    def test_create_user_success(self):
        """ユーザー登録_正常系"""
        # Arrange
        user_data = {
            "name": "田中太郎",
            "email": "tanaka@example.com",
            "password": "SecurePass123"
        }

        # Act
        response = client.post("/api/users", json=user_data)

        # Assert
        assert response.status_code == 201
        assert response.json()["name"] == "田中太郎"
        assert response.json()["email"] == "tanaka@example.com"
        assert "password" not in response.json()  # パスワードは返さない

    def test_create_user_duplicate_email(self):
        """ユーザー登録_メールアドレス重複"""
        # Arrange
        user_data = {
            "name": "田中太郎",
            "email": "tanaka@example.com",
            "password": "SecurePass123"
        }
        client.post("/api/users", json=user_data)  # 1回目登録

        # Act
        response = client.post("/api/users", json=user_data)  # 2回目登録

        # Assert
        assert response.status_code == 400
        assert "already exists" in response.json()["detail"]
```

**2. E2Eテスト実施**

**参照ドキュメント**: `2.5.5_E2Eテスト設計.md`

**ツール**: Playwright（推奨）

```typescript
// E2Eテスト例（Playwright）

import { test, expect } from '@playwright/test';

test.describe('ユーザー登録フロー', () => {
  test('ユーザー登録→ログイン→ダッシュボード表示', async ({ page }) => {
    // 1. ユーザー登録
    await page.goto('https://stg.example.com/signup');
    await page.fill('input[name="name"]', '田中太郎');
    await page.fill('input[name="email"]', 'tanaka@example.com');
    await page.fill('input[name="password"]', 'SecurePass123');
    await page.click('button[type="submit"]');

    // 登録完了メッセージ確認
    await expect(page.locator('text=登録が完了しました')).toBeVisible();

    // 2. ログイン
    await page.goto('https://stg.example.com/login');
    await page.fill('input[name="email"]', 'tanaka@example.com');
    await page.fill('input[name="password"]', 'SecurePass123');
    await page.click('button[type="submit"]');

    // 3. ダッシュボード表示確認
    await expect(page).toHaveURL('https://stg.example.com/dashboard');
    await expect(page.locator('text=ようこそ、田中太郎さん')).toBeVisible();
  });
});
```

**3. 性能テスト実施**

**参照ドキュメント**: `2.5.6_性能テスト/`

**ツール**: Locust（Python）、k6（JavaScript）

```python
# 性能テスト例（Locust）

from locust import HttpUser, task, between

class APIUser(HttpUser):
    """APIユーザー"""
    wait_time = between(1, 3)  # 1-3秒待機

    @task
    def get_users(self):
        """ユーザー一覧取得"""
        self.client.get("/api/users", headers={"Authorization": "Bearer test-token"})

    @task(3)  # 重み3倍
    def get_user(self):
        """ユーザー詳細取得"""
        self.client.get("/api/users/1", headers={"Authorization": "Bearer test-token"})

# 実行コマンド:
# locust -f tests/performance/locustfile.py --host=https://stg.example.com
```

**性能テスト結果の評価:**

```markdown
## 性能テスト結果

### 負荷テスト（同時接続100ユーザー）
| エンドポイント | 平均レスポンス | 95%ile | 99%ile | 目標 | 合否 |
|-------------|--------------|--------|--------|------|------|
| GET /api/users | 250ms | 450ms | 600ms | 500ms | ✅ |
| GET /api/users/{id} | 150ms | 300ms | 400ms | 500ms | ✅ |
| POST /api/users | 350ms | 550ms | 700ms | 500ms | ❌ |

### 不合格項目の対応
- POST /api/users: レスポンスタイム超過
- 対応方針: データベースインデックス追加、クエリ最適化
```

**4. セキュリティテスト実施**

**参照ドキュメント**: `2.5.8_セキュリティテスト/`、`49_security.md`

**ツール**: OWASP ZAP、Snyk、Trivy

```bash
# 脆弱性スキャン例（OWASP ZAP）

# ZAPをDockerで起動
docker run -t owasp/zap2docker-stable zap-baseline.py \
  -t https://stg.example.com \
  -r zap-report.html

# 依存関係スキャン（Python）
pip install pip-audit
pip-audit

# 依存関係スキャン（Node.js）
npm audit
```

**セキュリティテスト項目:**

```markdown
## セキュリティテスト結果

### 認証・認可テスト
- [ ] 未認証アクセス拒否: ✅ 合格
- [ ] 権限外リソースアクセス拒否: ✅ 合格
- [ ] JWT トークン検証: ✅ 合格

### 入力バリデーションテスト
- [ ] SQLインジェクション対策: ✅ 合格
- [ ] XSS対策: ✅ 合格
- [ ] CSRF対策: ✅ 合格

### データ保護テスト
- [ ] TLS接続確認: ✅ 合格
- [ ] パスワードハッシュ化確認: ✅ 合格
- [ ] センシティブデータマスキング: ✅ 合格

### 脆弱性スキャン結果
- Critical: 0件 ✅
- High: 0件 ✅
- Medium: 2件（依存ライブラリの古いバージョン）
- Low: 5件（軽微な改善推奨事項）

### 対応方針
- Medium: ライブラリをアップデート
- Low: 次回リリースで対応
```

**5. UAT実施**

**参照ドキュメント**: `2.5.9_受入テスト（UAT）/`

**ユーザーへの確認:**

> 「統合テスト、E2Eテスト、性能テスト、セキュリティテストが完了しました。
>
> 次に、ユーザー受入テスト（UAT）を実施します。
>
> **UAT計画:**
> - テスト環境: https://stg.example.com
> - 参加者: ○○部門のユーザー3名
> - 実施期間: 2025-11-01 〜 2025-11-05（5日間）
> - テストシナリオ: 実業務に基づく10シナリオ
>
> UAT計画書を作成しますか？または、すぐにUATを開始しますか？」

### 3.3 Check（確認）

**テスト結果を振り返る**

**確認すべき項目:**
- [ ] すべてのテストが実施されたか
- [ ] 不具合がすべて記録されたか
- [ ] Critical/Highの不具合は修正されたか
- [ ] テストカバレッジ目標を達成したか（80%以上）

### 3.4 Act（改善）

**不具合を修正して再テスト**

**例:**

> 「テスト結果を確認しました。以下の不具合が見つかりました:
>
> **Critical/High不具合:**
> - BUG-001: ユーザー更新時、メールアドレスの重複チェックが機能していない（High）
> - BUG-003: 認証トークンの有効期限チェックが機能していない（Critical）
>
> **Medium不具合:**
> - BUG-005: レポート出力が遅い（Medium）
>
> **対応方針:**
> 1. Critical/High不具合を優先修正
> 2. 修正後、再テストを実施
> 3. Medium不具合は次回リリースで対応
>
> 不具合修正を開始しますか？」

---

## §4 PDCA 2周目（不具合修正・品質保証）

### 4.1 Plan（計画）

**1周目で発見した不具合を振り返る**

**確認すべき項目:**
- [ ] すべての不具合がトリアージされたか（優先度付け）
- [ ] Critical/Highの不具合の修正計画があるか
- [ ] 再テストのスコープが明確か

### 4.2 Do（実行）

**不具合を修正して再テストを実施**

**不具合修正の流れ:**

1. **不具合の優先度付け**
   - Critical: 本番リリース前に必ず修正
   - High: 本番リリース前に必ず修正
   - Medium: 本番リリース後に対応可能（ただし2件以下）
   - Low: 次回リリースで対応

2. **不具合修正**
   - 実装コードを修正
   - 単体テストを追加（同じ不具合を再発させない）
   - 再テストを実施

3. **再テスト**
   - 修正した機能のテストを再実施
   - 関連する機能のリグレッションテスト（デグレード確認）

**例:**

> 「不具合を修正しました。再テストを実施します。
>
> **修正内容:**
> - BUG-001: ユーザー更新時のメールアドレス重複チェックを実装
> - BUG-003: 認証トークンの有効期限チェックを実装
>
> **再テスト:**
> - PUT /api/users/{id} の統合テスト
> - 認証・認可の統合テスト
> - リグレッションテスト（関連機能のデグレード確認）
>
> （再テスト実施）
>
> **再テスト結果:**
> - すべてのテストがパス ✅
> - リグレッションテスト: 問題なし ✅
>
> 不具合が修正されました。次のフェーズに進みますか？」

### 4.3 Check（確認）

**テストフェーズ完了条件のチェック**

**参照ドキュメント**: `2.5.14_フェーズ完了基準.md`

#### チェックリスト

**A. テスト実施完了**
- [ ] 統合テスト完了（主要フロー100%）
- [ ] E2Eテスト完了（重要シナリオ）
- [ ] 性能テスト完了（非機能要件クリア）
- [ ] セキュリティテスト完了（脆弱性ゼロまたは低リスクのみ）
- [ ] UAT完了・ユーザー承認取得

**B. 品質基準達成**
- [ ] Critical/Highの不具合ゼロ
- [ ] Mediumの不具合2件以下
- [ ] 単体テストカバレッジ80%以上（実装フェーズで達成済み）

**C. ドキュメント完成**
- [ ] テスト計画書作成完了
- [ ] テスト結果報告書作成完了
- [ ] テストコード整備完了
- [ ] 不具合管理台帳更新完了

**D. 承認取得**
- [ ] プロジェクトマネージャー承認
- [ ] ユーザー部門承認（UAT）
- [ ] 品質保証チーム承認（該当する場合）

### 4.4 Act（改善）

**「もっといい提案」を準備**

**ユーザーへの提案例:**

> 「テストフェーズが完了しました。最後に振り返りをさせてください。
>
> **テスト結果:**
> - 統合テスト: 25件実施、すべてパス ✅
> - E2Eテスト: 10シナリオ実施、すべてパス ✅
> - 性能テスト: 目標達成（レスポンスタイム500ms以内）✅
> - セキュリティテスト: 脆弱性ゼロ ✅
> - UAT: ユーザー承認取得 ✅
>
> **品質指標:**
> - 単体テストカバレッジ: 87%（目標80%達成）✅
> - 不具合: Critical/High 0件、Medium 1件 ✅
>
> **改善提案:**
> 1. **監視強化**: New RelicまたはDatadogを導入して、本番環境のパフォーマンス監視
>    - 効果: 本番環境での問題を早期検出
> 2. **自動テスト強化**: E2Eテストを夜間バッチで自動実行
>    - 効果: リグレッションテストの自動化
>
> これらを採用しますか？または、現在の状態で納品フェーズに進みますか？」

---

## §5 テスト成果物生成

### 5.1 テスト計画書生成

**参照ドキュメント**: `2.5.12_製造物_テスト計画書構成.md`

#### テスト計画書の構成

```markdown
# テスト計画書

## 1. テスト概要
- 1.1 目的
- 1.2 スコープ
- 1.3 前提条件

## 2. テスト戦略
- 2.1 テストレベル
  - 統合テスト
  - E2Eテスト
  - 性能テスト
  - セキュリティテスト
  - UAT
- 2.2 テスト手法
- 2.3 カバレッジ目標

## 3. テストスケジュール
- 3.1 マイルストーン
- 3.2 詳細スケジュール

## 4. テスト環境
- 4.1 ハードウェア構成
- 4.2 ソフトウェア構成
- 4.3 ネットワーク構成

## 5. テスト体制
- 5.1 役割と責任
- 5.2 連絡体制

## 6. テストケース一覧
- 6.1 統合テスト
- 6.2 E2Eテスト
- 6.3 性能テスト
- 6.4 セキュリティテスト

## 7. 不具合管理
- 7.1 報告方法
- 7.2 優先度定義
- 7.3 対応フロー

## 8. リスクと対策
- 8.1 リスク一覧
- 8.2 対策
```

**生成場所**: `docs/test/テスト計画書.md`

### 5.2 テスト結果報告書生成

**参照ドキュメント**: `2.5.13_製造物_テスト結果報告書.md`

#### テスト結果報告書の構成

```markdown
# テスト結果報告書

## 1. テスト実施サマリー
- 実施期間: 2025-11-01 〜 2025-11-10
- 参加者: 開発チーム3名、ユーザー部門3名
- 実施テストケース数: 75件

## 2. テスト結果概要

| テストレベル | 実施数 | 合格 | 不合格 | 未実施 |
|-------------|--------|------|--------|--------|
| 統合テスト | 25 | 25 | 0 | 0 |
| E2Eテスト | 10 | 10 | 0 | 0 |
| 性能テスト | 15 | 15 | 0 | 0 |
| セキュリティテスト | 20 | 20 | 0 | 0 |
| UAT | 5 | 5 | 0 | 0 |
| **合計** | **75** | **75** | **0** | **0** |

### テストカバレッジ
- 単体テスト: 87%（目標80%達成✅）
- 統合テスト: 主要フロー100%（目標100%達成✅）

## 3. 不具合サマリー

| 優先度 | 発見数 | 修正完了 | 未修正 |
|--------|--------|---------|--------|
| Critical | 1 | 1 | 0 |
| High | 2 | 2 | 0 |
| Medium | 3 | 2 | 1 |
| Low | 5 | 0 | 5 |
| **合計** | **11** | **5** | **6** |

### 未修正の不具合
| ID | 内容 | 優先度 | 対応方針 |
|----|------|--------|---------|
| BUG-005 | レポート出力が遅い | Medium | 次回リリースで最適化 |
| BUG-007 | エラーメッセージ改善 | Low | 本番リリース後に対応 |
| ... | ... | Low | ... |

## 4. 品質評価

### 目標達成状況
- ✅ テストカバレッジ80%以上達成
- ✅ Critical/High不具合ゼロ
- ✅ 性能要件クリア（レスポンスタイム500ms以内）
- ✅ セキュリティ脆弱性ゼロ
- ✅ UAT合格・ユーザー承認取得

### リスク評価
- **残存リスク**: Medium不具合1件（レポート出力の遅延）
  - 影響: 一部ユーザーが不便を感じる可能性
  - 対策: 次回リリースで最適化予定

## 5. 結論

### 本番リリース可否判断
**本番リリース可能 ✅**

- すべてのテストが完了
- Critical/High不具合ゼロ
- 品質基準を満たす
- ユーザー承認取得済み

### 次フェーズへの引継ぎ事項
- 未修正のMedium/Low不具合リスト（次回リリースで対応）
- 監視設定の確認（CloudWatch、Datadog等）
- 本番環境デプロイ手順の確認
```

**生成場所**: `docs/test/テスト結果報告書.md`

---

## §6 次フェーズへの遷移判定

### 6.1 テストフェーズ完了条件

以下がすべて満たされたら、納品フェーズへ遷移できます:

#### A. テスト実施完了
- [ ] 統合テスト完了（主要フロー100%）
- [ ] E2Eテスト完了（重要シナリオ）
- [ ] 性能テスト完了（非機能要件クリア）
- [ ] セキュリティテスト完了（脆弱性ゼロまたは低リスクのみ）
- [ ] UAT完了・ユーザー承認取得

#### B. 品質基準達成
- [ ] Critical/Highの不具合ゼロ
- [ ] Mediumの不具合2件以下
- [ ] 単体テストカバレッジ80%以上（実装フェーズで達成済み）

#### C. ドキュメント完成
- [ ] テスト計画書作成完了
- [ ] テスト結果報告書作成完了
- [ ] 不具合管理台帳更新完了

#### D. 承認取得
- [ ] プロジェクトマネージャー承認
- [ ] ユーザー部門承認（UAT）

### 6.2 次フェーズへの遷移

**ユーザーへの確認:**

> 「テストフェーズが完了しました。
>
> **テスト成果物:**
> - テスト計画書: `docs/test/テスト計画書.md`
> - テスト結果報告書: `docs/test/テスト結果報告書.md`
> - カバレッジレポート: `coverage/`
>
> **品質指標:**
> - 単体テストカバレッジ: 87%（目標80%達成）✅
> - 不具合: Critical/High 0件、Medium 1件 ✅
> - ユーザー承認: 取得済み ✅
>
> **次フェーズ（納品フェーズ）への引継ぎ事項:**
> - 未修正のMedium/Low不具合リスト
> - 本番環境デプロイ準備状況
> - 監視設定の確認
>
> 納品フェーズに進んで、本番リリースの準備を開始しますか？」

**プロジェクト状態の更新:**

```json
{
  "projectName": "プロジェクト名",
  "currentPhase": "delivery",
  "status": "ongoing",
  "completedPhases": ["planning", "requirements", "design", "implementation", "testing"],
  "updatedAt": "2025-10-24T12:00:00Z"
}
```

---

## 📚 参考資料

### テストフェーズの詳細プロセス

以下のファイルは、必要に応じて参照してください（必須ではありません）:

| ファイル | 内容 | 参照タイミング |
|---------|------|---------------|
| `2.5.0_事前調査.md` | 技術標準参照、最新ツール調査 | テスト計画時 |
| `2.5.1_フェーズ概要.md` | テストフェーズの目的と概要 | フェーズ開始時 |
| `2.5.2_テスト戦略策定.md` | テスト戦略の立案 | テスト計画時 |
| `2.5.4_結合テスト/` | 統合テストの設計 | 統合テスト実施時 |
| `2.5.5_E2Eテスト設計.md` | E2Eテストの設計 | E2Eテスト実施時 |
| `2.5.6_性能テスト/` | 性能テストの設計 | 性能テスト実施時 |
| `2.5.8_セキュリティテスト/` | セキュリティテストの設計 | セキュリティテスト実施時 |
| `2.5.9_受入テスト（UAT）/` | UAT計画と実施 | UAT実施時 |
| `2.5.12_製造物_テスト計画書構成.md` | テスト計画書テンプレート | 計画書生成時 |
| `2.5.13_製造物_テスト結果報告書.md` | テスト結果報告書テンプレート | 報告書生成時 |

### 技術標準

`.claude/docs/40_standards/` の技術標準を参照してください。

特に重要:
- `49_security.md` - セキュリティテスト項目（必須）
- 各言語の技術標準（テストセクション）

---

## 🚨 重要な注意事項

### 1. 単体テストは実装フェーズで完了済み

**テストフェーズでは統合テスト以降を実施**

✅ Good:
> 「実装フェーズで単体テストカバレッジ87%を達成済みです。
> テストフェーズでは、統合テスト、E2Eテスト、性能テスト、セキュリティテストを実施します。」

❌ Bad:
> 「テストフェーズで単体テストから実施します。」

### 2. セキュリティテストは必須

**`.claude/docs/40_standards/49_security.md` を参照してセキュリティテスト項目を網羅**

✅ Good:
```markdown
## セキュリティテスト項目（49_security.md準拠）

- [ ] 認証・認可テスト
- [ ] 入力バリデーションテスト（SQLインジェクション、XSS）
- [ ] データ保護テスト（TLS、パスワードハッシュ化）
- [ ] 脆弱性スキャン（OWASP Top 10）
- [ ] 依存関係スキャン（脆弱なライブラリ）
```

❌ Bad:
```markdown
## セキュリティテスト

- 正常系のテストのみ実施
→ セキュリティテストを省略
```

### 3. 不具合は優先度付けして管理

**Critical/Highは必ず修正、Mediumは2件以下**

✅ Good:
```markdown
## 不具合管理

| ID | 内容 | 優先度 | 対応方針 |
|----|------|--------|---------|
| BUG-001 | 認証エラー | Critical | 即座に修正 |
| BUG-002 | データ不整合 | High | 本日中に修正 |
| BUG-005 | レポート遅延 | Medium | 次回リリースで対応 |
```

❌ Bad:
```markdown
## 不具合管理

- Critical/High不具合を放置して次フェーズに進む
→ 本番環境で重大な問題発生
```

### 4. UAT完了・ユーザー承認取得は必須

**ユーザー受入テストを実施して、ユーザー承認を取得**

✅ Good:
```markdown
## UAT結果

- 実施期間: 2025-11-01 〜 2025-11-05
- 参加者: ○○部門のユーザー3名
- テスト結果: すべて合格
- **ユーザー承認: 取得済み ✅**
```

❌ Bad:
```markdown
## UAT結果

- UATを省略して納品フェーズに進む
→ ユーザーが期待する動作と異なり、リリース後にトラブル
```

### 5. テスト成果物は必ず生成

**テスト計画書、テスト結果報告書を生成**

✅ Good:
```
docs/test/
├── テスト計画書.md
├── テスト結果報告書.md
└── カバレッジレポート/
```

❌ Bad:
```
テスト結果報告書を生成せずに次フェーズに進む
→ 品質保証の証跡がない
```

---

**作成日**: 2025-10-24
**対象フェーズ**: テスト
**重要度**: ⭐⭐⭐ 最重要
