# 2.5.10 テストカバレッジ基準

## 目的

テストカバレッジの目標値と測定方法を定義します。

---

## 🎯 カバレッジ目標

### 単体テスト

| 対象 | 目標カバレッジ |
|------|---------------|
| **全体** | 80%以上 |
| **重要な業務ロジック** | 90%以上 |
| **ユーティリティ関数** | 70%以上 |
| **インフラコード** | 60%以上（テスト可能な範囲） |

---

## 📊 言語別カバレッジ測定

### Python

```bash
# pytest-covでカバレッジ測定
pytest --cov=src --cov-report=html --cov-report=term tests/

# 出力例:
Name                Stmts   Miss  Cover
---------------------------------------
src/services.py       100     15    85%
src/models.py          50      5    90%
---------------------------------------
TOTAL                 150     20    87%
```

---

### TypeScript

```bash
# Jestでカバレッジ測定
npm test -- --coverage

# 出力例:
File         | % Stmts | % Branch | % Funcs | % Lines
---------|---------|----------|---------|--------
services.ts |   85.00 |    80.00 |   90.00 |   85.00
models.ts   |   90.00 |    85.00 |   95.00 |   90.00
---------|---------|----------|---------|--------
All files   |   87.00 |    82.00 |   92.00 |   87.00
```

---

### C#

```bash
# coverletでカバレッジ測定
dotnet test /p:CollectCoverage=true /p:CoverletOutputFormat=opencover

# reportgeneratorでHTML生成
reportgenerator -reports:coverage.opencover.xml -targetdir:coverage-report
```

---

### Go

```bash
# go testでカバレッジ測定
go test -coverprofile=coverage.out ./...
go tool cover -html=coverage.out -o coverage.html
```

---

## ✅ カバレッジ基準の適用

### 対象コード

```markdown
## カバレッジ測定対象

✅ 対象:
- ビジネスロジック（services/）
- ドメインモデル（models/）
- API ハンドラー（handlers/）
- ユーティリティ関数（utils/）

❌ 対象外:
- 自動生成コード
- テストコード自体
- マイグレーションファイル
- 設定ファイル
```

---

## 🎯 合格基準

```markdown
## CI/CDでのカバレッジチェック

### 必須条件
- ✅ 全体カバレッジ: 80%以上
- ✅ 新規追加コード: 80%以上

### 推奨条件
- ⭐ 重要な業務ロジック: 90%以上
- ⭐ 分岐カバレッジ: 75%以上
```

---

**作成日**: 2025-10-19
**重要度**: ⭐⭐⭐
