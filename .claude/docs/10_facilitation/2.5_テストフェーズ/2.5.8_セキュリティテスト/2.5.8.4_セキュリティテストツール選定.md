# 2.5.8.4 セキュリティテストツール選定

## 目的

プロジェクトに適したセキュリティテストツールを選定します。

---

## 🛠️ ツール比較表

| ツール | 種類 | ライセンス | 主な機能 | 推奨度 |
|--------|------|-----------|---------|--------|
| **OWASP ZAP** | 脆弱性スキャン | OSS（無料） | SQL injection, XSS検出 | ⭐⭐⭐ |
| **Snyk** | 依存関係スキャン | Free/Pro | npm, pip, go, dockerスキャン | ⭐⭐⭐ |
| **Trivy** | コンテナスキャン | OSS（無料） | Dockerイメージスキャン | ⭐⭐⭐ |
| **SonarQube** | コード品質・セキュリティ | Free/商用 | コード品質分析 | ⭐⭐ |
| **Burp Suite** | ペネトレーションテスト | Free/Pro | 手動ペンテスト | ⭐⭐ |
| **Metasploit** | ペネトレーションテスト | OSS（無料） | 高度な攻撃シミュレーション | ⭐ |
| **Gremlin** | カオステスト | 商用 | 障害注入 | ⭐ |

---

## 📊 ツール詳細

### 1. OWASP ZAP（推奨）

**用途**: 脆弱性自動スキャン

**メリット**:
- ✅ 無料・OSS
- ✅ Docker対応
- ✅ CI/CD統合が容易
- ✅ OWASP Top 10対応

**デメリット**:
- ❌ 誤検知がある
- ❌ 日本語ドキュメント少ない

**導入例**:

```yaml
# GitHub Actions
- name: ZAP Scan
  uses: zaproxy/action-baseline@v0.7.0
  with:
    target: 'https://staging.example.com'
```

**推奨プロジェクト**: すべて

---

### 2. Snyk（推奨）

**用途**: 依存関係の脆弱性スキャン

**メリット**:
- ✅ 多言語対応（npm, pip, go, docker等）
- ✅ 自動修正機能
- ✅ GitHub/GitLab統合
- ✅ 無料プラン充実

**デメリット**:
- ❌ 大規模プロジェクトでは有料プラン必須

**導入例**:

```yaml
# GitHub Actions
- name: Run Snyk
  uses: snyk/actions/node@master
  env:
    SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
```

**推奨プロジェクト**: すべて

---

### 3. Trivy（推奨）

**用途**: コンテナイメージの脆弱性スキャン

**メリット**:
- ✅ 無料・OSS
- ✅ 高速（数秒でスキャン完了）
- ✅ OS、アプリケーションライブラリ両方対応
- ✅ CI/CD統合が容易

**デメリット**:
- ❌ コンテナ専用（Webアプリケーション脆弱性は検出不可）

**導入例**:

```bash
# ローカルでスキャン
trivy image myapp:latest

# CI/CD
trivy image --exit-code 1 --severity CRITICAL,HIGH myapp:latest
```

**推奨プロジェクト**: Dockerを使用するすべてのプロジェクト

---

### 4. SonarQube

**用途**: コード品質・セキュリティ分析

**メリット**:
- ✅ コード品質とセキュリティを同時にチェック
- ✅ 多言語対応
- ✅ ダッシュボードで可視化

**デメリット**:
- ❌ セットアップが複雑
- ❌ 大規模プロジェクトでは商用版が必要

**導入例**:

```yaml
# GitHub Actions
- name: SonarCloud Scan
  uses: SonarSource/sonarcloud-github-action@master
  env:
    SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}
```

**推奨プロジェクト**: 中〜大規模プロジェクト

---

### 5. Burp Suite

**用途**: 手動ペネトレーションテスト

**メリット**:
- ✅ 詳細なリクエスト/レスポンス確認
- ✅ リクエスト改ざんが容易
- ✅ プロ版は自動スキャン機能あり

**デメリット**:
- ❌ プロ版は高価（年間約$500）
- ❌ 手動操作が必要

**推奨プロジェクト**: セキュリティ要件が高いプロジェクト

---

### 6. Metasploit

**用途**: 高度なペネトレーションテスト

**メリット**:
- ✅ 実際の攻撃手法をシミュレート可能
- ✅ 豊富なExploitモジュール

**デメリット**:
- ❌ 専門知識が必要
- ❌ 誤って本番環境を攻撃するリスク

**推奨プロジェクト**: セキュリティ専門家がいるプロジェクト

---

## 🎯 プロジェクト別推奨ツールセット

### 小規模プロジェクト（〜3人チーム）

```yaml
# 最小構成
- OWASP ZAP: 脆弱性スキャン
- Snyk: 依存関係スキャン
- npm audit / pip-audit: 依存関係チェック
```

**コスト**: 無料

---

### 中規模プロジェクト（4〜10人チーム）

```yaml
# 標準構成
- OWASP ZAP: 脆弱性スキャン
- Snyk Pro: 依存関係スキャン（自動PR作成）
- Trivy: コンテナスキャン
- SonarCloud: コード品質・セキュリティ分析
```

**コスト**: 月額$50〜$200

---

### 大規模プロジェクト（11人以上）

```yaml
# フル構成
- OWASP ZAP: 自動脆弱性スキャン
- Burp Suite Pro: 手動ペネトレーションテスト
- Snyk Enterprise: 依存関係スキャン
- Trivy: コンテナスキャン
- SonarQube Enterprise: コード品質分析
- Metasploit: 定期的な高度なペンテスト
```

**コスト**: 月額$500〜$2,000

---

## 📋 選定基準

### 1. プロジェクト規模

| 規模 | チーム人数 | 推奨ツール |
|------|-----------|-----------|
| 小規模 | 〜3人 | OWASP ZAP, Snyk Free |
| 中規模 | 4〜10人 | + SonarCloud, Trivy |
| 大規模 | 11人以上 | + Burp Suite Pro, Metasploit |

### 2. セキュリティ要件

| 要件レベル | 推奨ツール |
|-----------|-----------|
| 低 | 自動スキャンのみ（ZAP, Snyk） |
| 中 | + 手動ペンテスト（Burp Suite） |
| 高 | + 専門家によるペンテスト（Metasploit） |

### 3. 予算

| 予算 | 推奨ツール |
|------|-----------|
| 無料 | OWASP ZAP, Snyk Free, Trivy |
| 月額〜$200 | + Snyk Pro, SonarCloud |
| 月額$500以上 | + Burp Suite Pro, Metasploit Pro |

---

## ✅ 最終推奨セット

### すべてのプロジェクトで必須

```yaml
必須ツール:
  - OWASP ZAP: 脆弱性スキャン（無料）
  - Snyk: 依存関係スキャン（Free/Pro）
  - Trivy: コンテナスキャン（無料・Docker使用時）
  - npm audit / pip-audit: 依存関係チェック（無料）
```

### オプション（予算・要件に応じて）

```yaml
オプション:
  - SonarQube: コード品質分析
  - Burp Suite: 手動ペンテスト
  - Metasploit: 高度なペンテスト
```

---

**作成日**: 2025-10-19
**重要度**: ⭐⭐⭐
