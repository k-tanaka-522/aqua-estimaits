# 2.2.9 次フェーズへの引継ぎ事項（要件定義フェーズ → 設計フェーズ）

## 📋 このドキュメントの目的

要件定義フェーズで確定した情報を**設計フェーズに正しく引き継ぐ**ための手順を定義する。

**重要:** 引き継ぎ漏れがあると、設計フェーズで手戻りが発生する。

---

## 📦 引き継ぐべき情報リスト

### 1. 要件定義書

#### ファイルパス

`docs/02_要件定義書.md`

#### 内容

- プロジェクト概要
- 機能要件（機能一覧、機能詳細仕様）
- 非機能要件（性能、可用性、セキュリティ、運用）
- データ要件（ER図、データ項目定義、データ量）
- 外部連携仕様
- 制約事項
- 優先順位（MoSCoW）

#### 設計フェーズでの利用方法

- **技術選定の基準**として利用
  - 非機能要件（性能、可用性）を満たす技術スタックを選定
  - 例: レスポンスタイム3秒以内 → CDN、キャッシュ戦略を検討

- **アーキテクチャ設計の基準**として利用
  - データ量、同時ユーザー数からスケーラビリティを設計
  - 例: 同時100ユーザー → Auto Scaling、ロードバランサー

- **セキュリティ設計の基準**として利用
  - セキュリティ要件を満たす認証・認可方式を選定
  - 例: 多要素認証（SMS） → AWS Cognito、Auth0等を検討

---

### 2. 画面遷移図

#### ファイルパス

`docs/diagrams/画面遷移図.md` (Mermaid形式)

#### 内容

- 画面一覧（画面ID、画面名、画面概要）
- 画面遷移フロー（Mermaid flowchart）
- 遷移条件

#### 設計フェーズでの利用方法

- **フロントエンド設計の基準**として利用
  - 画面数、画面遷移からルーティング設計
  - 例: 10画面 → React Router、Vue Router等のルーティング設計

- **状態管理の設計**として利用
  - 画面間で共有する状態を設計
  - 例: ログイン状態、ユーザー情報 → Context API、Vuex等

---

### 3. ER図

#### ファイルパス

`docs/diagrams/ER図.md` (Mermaid erDiagram形式)

#### 内容

- エンティティ一覧
- リレーション（1:1, 1:N, N:N）
- 属性（データ項目）

#### 設計フェーズでの利用方法

- **データベーススキーマ設計の基準**として利用
  - ER図からテーブル定義を作成
  - 例: User, Customer, SalesReport → CREATE TABLE文

- **ORM設計**として利用
  - エンティティからORMモデルを設計
  - 例: SQLAlchemy（Python）、TypeORM（Node.js）等

---

### 4. 非機能要件（数値目標）

#### 内容

- 性能要件（レスポンスタイム、スループット、データ処理量）
- 可用性要件（稼働時間、目標稼働率、RTO/RPO）
- セキュリティ要件（認証、認可、暗号化、監査ログ）
- 運用要件（バックアップ、監視、ログ保持）

#### 設計フェーズでの利用方法

- **技術選定の基準**として利用
  - 性能要件を満たす技術を選定
  - 例: レスポンスタイム3秒以内 → インメモリキャッシュ（Redis）、CDN

- **インフラ設計の基準**として利用
  - 可用性要件を満たすインフラを設計
  - 例: 99.9%稼働率 → Multi-AZ、Auto Scaling

- **セキュリティ設計の基準**として利用
  - セキュリティ要件を満たす設計
  - 例: TLS 1.2以上 → ALB、CloudFront設定

---

### 5. 外部連携仕様

#### 内容

- 連携先システム（システム名、連携目的）
- 連携方式（API/ファイル/DB）
- 連携タイミング（リアルタイム/バッチ）
- 連携データ項目
- エラー時の対応

#### 設計フェーズでの利用方法

- **API設計の基準**として利用
  - 外部連携用のAPIエンドポイント設計
  - 例: REST API、GraphQL

- **バッチ処理設計**として利用
  - バッチ処理のスケジュール設計
  - 例: AWS Lambda + EventBridge、cron

---

### 6. 制約事項

#### 内容

- 技術制約（既存システムとの互換性）
- スケジュール制約（開発期間、リリース日）
- 予算制約（開発予算、インフラコスト）
- 法令・規制制約（個人情報保護法等）

#### 設計フェーズでの利用方法

- **技術選定の制約**として利用
  - 既存システムとの互換性を考慮した技術選定
  - 例: 既存システムがCSV連携のみ → ファイル連携設計

- **コスト設計の制約**として利用
  - 予算内に収まるインフラ設計
  - 例: 月額3万円以内 → t3.small、RDS t3.micro等

---

### 7. 優先順位（MoSCoW）

#### 内容

- Must（必須機能）- MVP
- Should（重要機能）- フェーズ1完成まで
- Could（可能であれば）- フェーズ2以降
- Won't（今回は実装しない）

#### 設計フェーズでの利用方法

- **設計の優先順位**として利用
  - Mustの機能を優先的に設計
  - Shouldの機能は後回し

- **アーキテクチャの拡張性設計**として利用
  - Couldの機能を将来追加できるよう拡張性を考慮
  - 例: モバイルアプリ（Could）→ RESTful API設計

---

## 📝 プロジェクト状態の更新

### `.claude-state/project-state.json` の更新

要件定義フェーズ完了時に、プロジェクト状態を更新：

#### 更新内容

```json
{
  "projectName": "○○システム",
  "currentPhase": "design",
  "status": "ongoing",
  "completedPhases": ["planning", "requirements"],
  "updatedAt": "2025-01-27T16:00:00Z",
  "artifacts": {
    "planning": "docs/01_企画書.md",
    "requirements": "docs/02_要件定義書.md",
    "diagrams": [
      "docs/diagrams/画面遷移図.md",
      "docs/diagrams/ER図.md"
    ]
  },
  "nextActions": [
    "技術標準（`.claude/docs/40_standards/`）の参照開始",
    "技術スタックの選定",
    "アーキテクチャ設計"
  ]
}
```

#### 更新タイミング

**要件定義フェーズ完了 → 設計フェーズ開始前**

---

## 🚀 設計フェーズへの移行手順

### ステップ1: 引継ぎ事項の確認

AIファシリテーターが以下を確認：

- [ ] 要件定義書が存在する（`docs/02_要件定義書.md`）
- [ ] 画面遷移図が存在する（`docs/diagrams/画面遷移図.md`）
- [ ] ER図が存在する（`docs/diagrams/ER図.md`）
- [ ] プロジェクト状態が更新されている（`.claude-state/project-state.json`）

---

### ステップ2: 設計フェーズの説明

AIファシリテーターがユーザーに説明：

```markdown
AI: 要件定義フェーズが完了しました。
    次の設計フェーズに進みます。

【設計フェーズで実施すること】

1. 技術スタックの選定
   - プログラミング言語（Python/Node.js/C#/Go等）
   - フレームワーク（FastAPI/Express/ASP.NET Core等）
   - データベース（PostgreSQL/MySQL/DynamoDB等）
   - インフラ（AWS/Azure/GCP等）

2. アーキテクチャ設計
   - システム構成図（詳細レベル）
   - レイヤー構成（プレゼンテーション層/ビジネスロジック層/データアクセス層）
   - 設計パターン（Clean Architecture/Hexagonal Architecture等）

3. データベーススキーマ設計
   - テーブル定義（CREATE TABLE文）
   - インデックス設計
   - マイグレーション戦略

4. API設計
   - エンドポイント一覧
   - リクエスト/レスポンス仕様
   - エラーハンドリング

⭐⭐⭐ 重要: 設計フェーズでは、技術標準（`.claude/docs/40_standards/`）を参照します

【参照する技術標準ファイル】
- 4.3 AWS CloudFormation規約
- 4.4 Terraform規約
- 4.5 Python規約（Python選定時）
- 4.6 Node.js/TypeScript規約（Node.js選定時）
- 4.7 C# .NET Core規約（C#選定時）
- 4.8 Go言語規約（Go選定時）
- 4.9 セキュリティ・運用基準 ⭐⭐⭐必須

これにより、社内標準に準拠した高品質な設計を実現します。

設計フェーズに進んでよろしいでしょうか？
```

---

### ステップ3: ユーザー承認の取得

```markdown
ユーザー: はい、進めてください。

AI: ありがとうございます。それでは設計フェーズを開始します。
```

---

### ステップ4: 設計フェーズ開始

AIファシリテーターが実施：

1. **プロジェクト状態を更新**
   - `.claude-state/project-state.json` の `currentPhase` を "design" に更新

2. **設計フェーズのドキュメントを参照**
   - `.claude/docs/02_プロセス定義/2.3_設計フェーズ/` を参照
   - `2.3.0_事前調査.md` を実行（WebSearch + 技術標準参照）

3. **設計フェーズのヒアリング開始**
   - 技術スタックの選定ヒアリング
   - アーキテクチャの希望ヒアリング

---

## 🔍 設計フェーズで参照すべき情報

### 要件定義フェーズから引き継がれた情報の利用方法

| 要件定義の情報 | 設計フェーズでの利用 |
|-------------|-------------------|
| **機能一覧** | API設計、画面設計の基準 |
| **画面遷移図** | フロントエンド設計、ルーティング設計 |
| **ER図** | データベーススキーマ設計、ORMモデル設計 |
| **非機能要件（性能）** | 技術選定、キャッシュ戦略、CDN設計 |
| **非機能要件（可用性）** | インフラ設計（Multi-AZ、Auto Scaling） |
| **非機能要件（セキュリティ）** | 認証・認可設計、暗号化設計 |
| **非機能要件（運用）** | 監視設計、バックアップ設計 |
| **外部連携仕様** | API設計、バッチ処理設計 |
| **制約事項** | 技術選定の制約、コスト設計 |
| **優先順位（MoSCoW）** | 設計の優先順位、拡張性設計 |

---

## 📋 引継ぎチェックリスト

### 成果物の確認

- [ ] 要件定義書（`docs/02_要件定義書.md`）
- [ ] 画面遷移図（`docs/diagrams/画面遷移図.md`）
- [ ] ER図（`docs/diagrams/ER図.md`）
- [ ] プロジェクト状態（`.claude-state/project-state.json`）

### 引継ぎ内容の確認

- [ ] 機能一覧が明確
- [ ] 画面遷移が明確
- [ ] データモデルが明確
- [ ] 非機能要件が数値化されている
- [ ] 外部連携仕様が確定している
- [ ] 制約事項が明確
- [ ] 優先順位が決定している

### 設計フェーズの準備

- [ ] 設計フェーズのドキュメント（`.claude/docs/02_プロセス定義/2.3_設計フェーズ/`）を確認
- [ ] 技術標準（`.claude/docs/40_standards/`）の参照準備
- [ ] ユーザーに設計フェーズの説明を実施
- [ ] ユーザー承認を取得

---

## ⭐⭐⭐ 設計フェーズでの重要な変化

### 技術標準（`.claude/docs/40_standards/`）の参照開始

**要件定義フェーズまで**:
- 技術標準（`.claude/docs/40_standards/`）は参照しない
- WebSearchのみで事前調査
- 「何を作るか」に集中

**設計フェーズから** ⭐⭐⭐:
- **技術標準（`.claude/docs/40_standards/`）の参照開始**
- WebSearch + 技術標準（`.claude/docs/40_standards/`）で最適な提案
- 「何を守るか」を意識

### "生きた規約"の実現

**技術標準（`.claude/docs/40_standards/`）（静的）× WebSearch（動的）= 最適な提案**

1. **WebSearch**: 2025年時点の最新技術トレンドを調査
   - 例: 「Python Web フレームワーク 2025」
   - FastAPI が最新トレンドと判明

2. **技術標準参照**: 社内の Python規約を確認
   - 例: `.claude/docs/40_standards/41_python.md` Python規約
   - FastAPI 推奨、プロジェクト構成、コーディング規約

3. **統合提案**: 両者を統合して最適な提案
   - 最新トレンド（FastAPI）+ 社内標準（Python規約）
   - = 社内標準に準拠した、モダンな設計

---

## 💡 AIファシリテーターとしての心構え

### 1. 引継ぎ漏れを防ぐ

- すべての成果物が存在することを確認
- 引継ぎチェックリストを厳守
- 不足があれば要件定義フェーズに戻る

### 2. 設計フェーズへの期待値を設定

- 設計フェーズで何をするか明確に説明
- 技術標準（`.claude/docs/40_standards/`）の参照開始を強調
- "生きた規約"の価値を伝える

### 3. ユーザーの成長を支援

- なぜ技術標準を参照するのか説明
- 社内標準に準拠することの価値を説明
- ユーザーが納得した上で進める

---

## 📚 関連ドキュメント

### 要件定義フェーズ

- `2.2.8_フェーズ完了基準.md` - 完了条件の確認
- `2.2.4_製造物_要件定義書構成.md` - 要件定義書の内容確認

### 設計フェーズ

- `.claude/docs/02_プロセス定義/2.3_設計フェーズ/2.3.1_フェーズ概要.md` - 設計フェーズの目的・ゴール
- `.claude/docs/02_プロセス定義/2.3_設計フェーズ/2.3.0_事前調査.md` - WebSearch + 技術標準参照

### 技術標準（`.claude/docs/40_standards/`）

- `.claude/docs/40_standards/45_cloudformation.md` AWS CloudFormation規約
- `.claude/docs/40_standards/46_terraform.md` Terraform規約
- `.claude/docs/40_standards/41_python.md` Python規約
- `.claude/docs/40_standards/42_typescript.md` Node.js/TypeScript規約
- `.claude/docs/40_standards/43_csharp.md` C# .NET Core規約
- `.claude/docs/40_standards/44_go.md` Go言語規約
- `.claude/docs/40_standards/49_security.md` セキュリティ・運用基準 ⭐⭐⭐

---

**最終更新**: 2025-10-19
**作成者**: Claude (AI開発ファシリテーター)
