# 2.4.10 製造物_IaC構成

## 目的

IaC（Infrastructure as Code）ファイルの配置場所を定義します。

---

## 📁 IaCファイルの配置

### 1. CloudFormation ⭐⭐⭐

**`infra/cloudformation/` に配置**:

```
infra/
└── cloudformation/
    ├── 01-network.yaml      # VPC, Subnet, IGW
    ├── 02-security.yaml     # SecurityGroup, IAM
    ├── 03-database.yaml     # RDS, DynamoDB
    ├── 04-compute.yaml      # ECS, ALB
    └── README.md            # デプロイ手順
```

---

### 2. Terraform ⭐⭐⭐

**`infra/terraform/` に配置**:

```
infra/
└── terraform/
    ├── modules/
    │   ├── vpc/
    │   ├── ecs/
    │   └── rds/
    ├── environments/
    │   ├── dev/
    │   ├── stg/
    │   └── prd/
    ├── backend.tf
    └── README.md            # デプロイ手順
```

---

### 3. 環境別設定 ⭐⭐

**環境別にディレクトリを分離**:

```
infra/
└── terraform/
    └── environments/
        ├── dev/
        │   ├── main.tf
        │   └── terraform.tfvars
        ├── stg/
        └── prd/
```

---

### 4. IaC用README.md ⭐⭐⭐

**必須記載事項**:

```markdown
# インフラ構築手順

## 前提条件
- AWS CLI設定済み
- Terraform v1.5以上

## デプロイ手順

### 1. dry-run（必須）
\`\`\`bash
terraform plan -out=tfplan
\`\`\`

### 2. ユーザー承認後に実行
\`\`\`bash
terraform apply tfplan
\`\`\`

## ロールバック手順
...
```

---

## ❌ Bad Example: 不適切な配置

```
myproject/
├── main.tf              # ❌ ルートに直接配置
└── cloudformation.yaml  # ❌ 環境分離なし
```

**問題点**:
- 環境分離されていない
- 保守性が低い

---

## ✅ Good Example: 適切な配置

```
myproject/
└── infra/
    ├── cloudformation/  # ✅ IaCツール別に分離
    └── terraform/
        ├── modules/     # ✅ モジュール化
        └── environments/ # ✅ 環境分離
```

**改善点**:
- ✅ 環境分離
- ✅ 保守性が高い
- ✅ 再利用性が高い

---

**作成日**: 2025-10-19
**対象フェーズ**: 実装
**重要度**: ⭐⭐⭐ 必須
