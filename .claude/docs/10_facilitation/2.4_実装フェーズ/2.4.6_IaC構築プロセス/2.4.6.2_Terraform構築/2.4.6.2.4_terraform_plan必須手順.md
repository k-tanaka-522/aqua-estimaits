# 2.4.6.2.4 Terraform plan必須手順

## 目的

本番環境への変更前に必ず `terraform plan` を実行します。

---

## ⚠️ terraform plan必須ルール

### 1. 本番環境への直接apply禁止 ⭐⭐⭐

```bash
# ❌ Bad Example: 直接apply
terraform apply

# ✅ Good Example: planで事前確認
terraform plan -out=tfplan
# レビュー後
terraform apply tfplan
```

---

### 2. planレビュープロセス ⭐⭐⭐

**手順**:
1. `terraform plan` 実行
2. 変更内容をユーザーに提示
3. ユーザー承認を得る
4. 承認後に `apply`

```bash
# 1. plan実行
terraform plan -out=tfplan

# 2. 変更内容を確認
terraform show tfplan

# 3. ユーザーに提示して承認を得る
echo "以下の変更を行います。承認してください："
echo "- ECSタスク定義の更新 (1 to add)"
echo "- ALBリスナールールの追加 (1 to add)"

# 4. 承認後にapply
terraform apply tfplan
```

---

### 3. 削除リソースの確認 ⭐⭐⭐

planで以下を確認：
- ✅ `# xxx will be destroyed` がないか
- ✅ `# xxx must be replaced` がないか
- ✅ データ損失のリスクはないか

---

**作成日**: 2025-10-19
**対象フェーズ**: 実装
**重要度**: ⭐⭐⭐ 必須
