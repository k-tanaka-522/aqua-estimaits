# 2.4.5.4.5 Goテストコード生成（testing+testify）

## 目的

`.claude/docs/40_standards/44_go.md` に準拠したGoテストコードを生成します。

---

## 🧪 testingパッケージの基本

### インストール

```bash
go get github.com/stretchr/testify
```

### テストファイルの配置

```
internal/
└── service/
    ├── user_service.go
    └── user_service_test.go
```

### 実行

```bash
go test ./...
go test -cover ./...
```

---

## ✅ テスト作成の原則

### 1. AAA (Arrange-Act-Assert) パターン ⭐⭐⭐

```go
package service

import (
    "testing"
    "github.com/stretchr/testify/assert"
)

func TestGetUser_Success(t *testing.T) {
    // Arrange
    service := NewUserService()
    userID := 1

    // Act
    user, err := service.GetUser(userID)

    // Assert
    assert.NoError(t, err)
    assert.NotNil(t, user)
    assert.Equal(t, userID, user.ID)
}
```

---

### 2. testifyによるアサーション ⭐⭐⭐

```go
import "github.com/stretchr/testify/assert"

func TestGetUser_NotFound(t *testing.T) {
    // Arrange
    service := NewUserService()

    // Act
    user, err := service.GetUser(999)

    // Assert
    assert.Error(t, err)
    assert.Nil(t, user)
}
```

---

### 3. Table Driven Tests ⭐⭐

```go
func TestValidateEmail(t *testing.T) {
    tests := []struct {
        name    string
        email   string
        want    bool
    }{
        {"valid email", "test@example.com", true},
        {"invalid email", "invalid@", false},
    }

    for _, tt := range tests {
        t.Run(tt.name, func(t *testing.T) {
            got := ValidateEmail(tt.email)
            assert.Equal(t, tt.want, got)
        })
    }
}
```

---

**作成日**: 2025-10-19
**対象フェーズ**: 実装
**重要度**: ⭐⭐⭐ 必須
